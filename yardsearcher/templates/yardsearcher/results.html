{% extends 'yardsearcher/base.html' %}
{% load static %}
{% block extra_links %}
    <link rel="stylesheet" href="{% static 'css/results.css' %}?v={{tz}}"/>
{% endblock %}
{% block main_content %}
    <div class="d-flex bg-primary flex-column p-0 vh-100 overflow-y-auto align-items-center col-12 col-md-10 col-lg-10 gap-4 ">
        <!-- This'll be the map w/ searchbar, btns and controls for this page -->
        <div class="map bg-secondary position-relative mt-md-4 d-flex p-4 col-12 col-md-10 col-lg-9 " id="resultsMap">
            <!-- This is the input and btns div -->
            <div class="d-flex flex-column gap-3 col">
                <form action="" method="get" class="p-0" >
                    <div class="input-group input-group-lg">
                        
                        <input type="text" name="q" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-lg" value="{{query}}">
                        <button type="submit" class="input-group-text" id="inputGroup-sizing-lg"><i class="bi bi-search"></i></button>
                    </div>
                </form> 
                <div class="d-flex flex-row gap-2">
                    <button class="btn btn-sm bg-white py-1" data-bs-toggle="modal" data-bs-target="#popupModal" aria-controls="popupModal">Manage Junkyards</button>
                </div>
            </div>
        </div>
        <div class=" d-flex flex-column col-12 col-md-10 col-lg-9 gap-4 px-4 px-md-0"  >
            {% for yard in fetched_yard_data %}

                <div class="yardResult bg-white p-4 accordion" id="{{yard.elem_id}}-accordion">
                    <div class="accordion-item border-0">
                        <!-- Header / Yard Meta -->
                        <div class="yardMeta d-flex flex-row gap-2 align-items-center">
                            <img src="" alt="" style="width:5rem; height:5rem" class="logo">
                            <div class="d-flex flex-column gap-2">
                                <h3 class="mb-0">{{yard.name|capfirst}}</h3>
                                <p class="mb-0">{{yard.num_results}} result(s) in {{yard.time_elapsed}} seconds</p>
                            </div>
                        </div>
                
                        <!-- Collapse Button -->
                        <div class="text-end">
                            <button class="btn btn-link p-0"
                                data-bs-toggle="collapse"
                                data-bs-target="#{{yard.elem_id}}"
                                aria-expanded="true"
                                aria-controls="{{yard.elem_id}}">
                                Collapse
                            </button>
                        </div>
                
                        <!-- Collapsible Section -->
                        <div id="{{yard.elem_id}}"
                            class="accordion-collapse collapse show"
                            data-bs-parent="#{{yard.elem_id}}-accordion">
                
                            <div class="accordion-body p-0">
                                <div class="table-responsive">
                                    <table class="table text-nowrap mb-0">
                                        <thead>
                                            <tr>
                                                {% for header in yard.result_headers %}
                                                    <th>{{header|capfirst}}</th>
                                                {% endfor %}
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for result_tuple in yard.results %}
                                                <tr>
                                                    {% for item in result_tuple %}
                                                        <td>{{item|capfirst}}</td>
                                                    {% endfor %}
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                
                        </div>
                
                    </div>
                
                </div>
            
            {% endfor%}
        </div>
    </div>
{% endblock %}


{% block popup-heading-text %} Manage Junkyards {% endblock %}
{% block popup-button-text %} Save Changes {% endblock %}
{% block popup-content %}
    <div class="d-grid gap-2" style="grid-template-columns: 1fr 1fr;">
        <div class="form-check d-flex gap-2">
            <input class="form-check-input" type="checkbox" value="" id="checkDefault">
            <label class="form-check-label d-flex flex-column" for="checkDefault">
                <span class="">Joliet U pullit</span>
                <span>X miles away</span>
            </label>
        </div>
    </div>
{% endblock %}
